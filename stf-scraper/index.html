<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    
      STF Scraper [script] — infoBAG
    
  </title>
  <meta name="title" content="infoBAG" />
  <meta name="description" content="can't steer unless already moving" />
  <link rel="canonical" href="https://ib.bsb.br/stf-scraper/">
  <link rel="alternate" type="application/rss+xml" title="infoBAG" href="https://ib.bsb.br/rss.xml">
  
    <meta itemprop="keywords" content="scripts,estudos">
    
      <meta property="article:tag" content="scripts">
    
      <meta property="article:tag" content="estudos">
    
  
  <link href="/style.css" rel="stylesheet">
  <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
  <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
  <script type="module">
    import PagefindHighlight from '/pagefind/pagefind-highlight.js';
    new PagefindHighlight({ highlightParam: "highlight" });
  </script>
  <script src="/assets/js/search.js" defer></script>
  <script src="/assets/js/prism.js" defer></script>
</head>
<body class="post-content-body">
  <header class="header-container">
    <div id="search" class="search-input-block"></div>
    <nav aria-label="Main navigation" class="header-content">
      <a href="/" aria-label="Home">
        <img src="/assets/Sudden_Death_Rune.gif" alt="Sudden Death Rune" class="favicon search-link">
      </a>
      <a href="https://ib.bsb.br/archive" aria-label="Archive">
        <img src="/favicon.ico" alt="Archive Icon" class="favicon search-link">
      </a>
      <a href="https://ib.bsb.br/tags" aria-label="Tags">
        <img src="/assets/Label.gif" alt="Tags Icon" class="favicon search-link">
      </a>
      <a href="https://ib.bsb.br/events" aria-label="Events">
        <img src="/assets/Paralyse_Rune.gif" alt="Events Icon" class="favicon search-link">
      </a>
    </nav>
  </header>
  <article class="post-wrapper">
    <div class="post-heading">
      <h1 class="post-title">STF Scraper [script]</h1>
      <div class="post-meta">
        <time datetime="2024-05-01T03:00:00+00:00" class="post-date">
          01 May 2024</time><span class="post-updated"> &rightarrowtail; <time datetime="2024-07-13T13:46:16+00:00">13 Jul 2024
          </time>
          </span>
        
        
        <div class="post-info">
          Edit: aberto.
        </div>
        
        
        <div class="post-tags">
          Tags:
          
          <a href="https://ib.bsb.br/tags/#scripts" class="tag">
            scripts
          </a>
          
          
          <a href="https://ib.bsb.br/tags/#estudos" class="tag">
            estudos
          </a>
          
          
        </div>
        
        <div class="post-actions">
          <a href="https://github.com/marioseixas/marioseixas.github.io/edit/main/_posts/2024-05-01-stf-scraper.md" target="_blank" rel="noopener noreferrer" class="btn-primary">
            Improve this page
          </a>&hArr;<a href="https://github.com/marioseixas/marioseixas.github.io/commits/main/_posts/2024-05-01-stf-scraper.md" target="_blank" rel="noopener noreferrer" class="btn-secondary">
            View revision history
          </a>
        </div>
      </div>
    </div>
    <aside class="aside">
      

      <div class="language-plaintext highlighter-rouge"><div class="highlight"><section><code>import json
from playwright.sync_api import sync_playwright
from bs4 import BeautifulSoup

def generate_url(assunto):
    """
    Generates a URL for the 'acordaos' base with the given subject.
    This function constructs a URL string that includes query parameters specifically designed to search within the 'acordaos' section of the STF website.
    """
    return f"https://jurisprudencia.stf.jus.br/pages/search?base=acordaos&amp;sinonimo=true&amp;plural=true&amp;page=1&amp;pageSize=250&amp;queryString={assunto}&amp;sort=_score&amp;sortBy=desc"

def parse_item(html_page):
    """
    Parses the HTML content to extract relevant data from 'acordaos'.
    This function navigates through the HTML structure of the webpage, identifying and extracting necessary details such as the title, ementa, judicial body, and more.
    """
    results = []
    soup = BeautifulSoup(html_page, "html.parser")
    data = soup.find_all("div", class_="result-container")
    for item in data:
        title_element = item.find("h4", class_="ng-star-inserted")
        ementa_element = item.find("span", class_="jud-text ng-star-inserted")
        if title_element and ementa_element:
            title = title_element.text.strip()
            ementa = ementa_element.text.strip()
            dates = item.find_all("span", style="font-weight: normal;")
            turma = dates[0].text.strip() if dates else ""
            ministro = dates[1].text.strip() if len(dates) &gt; 1 else ""
            indexacao_partes = [part.text.strip() for part in item.find_all("p", class_="jud-text m-0")]
            indexacao = indexacao_partes[0] if indexacao_partes else ""
            partes = indexacao_partes[1] if len(indexacao_partes) &gt; 1 else ""
            product = {
                "Title": title,
                "Ementa": ementa,
                "Orgao colegiado": turma,
                "Ministro": ministro,
                "Indexação": indexacao,
                "Partes": partes,
            }
            results.append(product)
    return results

def main(assunto):
    """
    Main function to launch the browser, scrape 'acordaos' data, and save it.
    This function uses the Playwright library to open a browser, navigate to the generated URL, and call the parsing function to extract and save the data.
    """
    url = generate_url(assunto)
    with sync_playwright() as pw:
        browser = pw.chromium.launch(headless=False) 
        page = browser.new_page()
        page.goto(url, wait_until="networkidle")
        parsed = parse_item(page.content())
        print(json.dumps(parsed, indent=3, ensure_ascii=False))
        with open(f"acordaos - {assunto}.json", "w", encoding="utf-8") as file:
            json.dump(parsed, file, indent=3, ensure_ascii=False)
        browser.close()

if __name__ == "__main__":
    assunto = input("Enter the subject for 'acordaos': ")
    main(assunto)
</code></section></div></div>

      <main class="content">        
      </main>
      
      <div class="nav-arrow prev">
        <a href="/whatsappy/" title="WhatsapPY data">
          <span aria-hidden="true"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAxVJREFUaEPt18FqG1cUBuD/nLkzI42UiVInkFLTCAKhS+9KA+3Kq1L8AAHjhR7AKz+ADV55qUfoqhvThTfdmC4KzTKmYJrELshJW9PIlSeKRpqZe88pUtouihvVRknqMNoMzD1zdPXNrzMM4RJ+6BLuGeWm39RdK6VL6VcIlPEo41HG401loJQupS8mUM7pi7md/6p3UtoHUJzf4vVecZb0e0EQfB7H8b0kSeqqummt/eb1buN83SebNsZ8QkQCYHVpaenu/v7+ra2tLRwdHWF1ddWq6hfM3BCRE2b+FcBHACQAHo1E5v9c+5mIhkR0e3z0VQ8LotuqWlXVw/GRmT8QkdMK89McuAOAAfwoIu8z85yIHBPRKRGN1/IAeDx0rul53hivo6psrf2ejDGfEtFOu92u7O3tBWtra2i322g0GhgOh9je3ka325UPax7fCR0iw+lp4aLxr70aeOmgkChTRY3JGSb73EroERD73uB54WpOgdhwZkXNQNQLiVDzOU1yFymAhu+lqZVopIqISQKmPLFS+atHv3A1q8AVQ/lXP/VHRPQx+b6frKysxMvLy1hfX0ez2USv18PCwgLiOEaSJKhWq/jhwQN8dnIfVOS4dsWHqCJ5YREGjBuNEMfd0eTc9WshBqnFYGhRqxrUIoNuLwMT4eb1Cp6dZshywdW6mZzr9QsEPuPmXIhfno3gnGKuEWCUC14MLKoVb1L72+8Zvj3JOl/udZt/S7darUqn0wlarRZ2d3cxPz+PJ8dPsPP1Doq8kIbL+cawjxBIM8MRFAidpBlRpIbhFc55gM2NF5IIQtVBRlRTZgTWZQ4wzvc8spO1NPM4Gr9Wh1bSDIjU98C5E0PIC8OVSX+Rlz08hl+4/LsML6X/menFxcW7BwcHtzY2NvDw8CE21zf/NdMAHskFMs3MT/EfMg3gsTsr02f8byfTo16v3+v3+//f6fGKgXNp5vT5huZbqH4nH+NvwXH6V5bS041mU1FKz8ZxepdSerrRbCpK6dk4Tu9SSk83mk1FKT0bx+ldSunpRrOpuJTSfwBcuImxpyA7XgAAAABJRU5ErkJggg==" alt="Previous" style="max-width: 45px; height: auto;"></span>
        </a>
      </div>
      
      
      <div class="nav-arrow next">
        <a href="/storj-sync/" title="Rclone: Syncing STORJ Cloud to Local Storage">
          <span aria-hidden="true"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAwdJREFUaEPtl01rG1cUht9z7p070ijKWLVS3I9YULtNMBRn2UIXxZtuvCjedNWfoKVXBvsHeOUfoIUx5AeY0pVXXSR052UxBJSi0kDiRplII83HvadI9CMtOFjCmBjubC7cc8+Zc555eYdLuIEP3cCe4Zu+rq/mSXvSbyHg5eHl4eVxXRrwpD3p+Qh4n56P2+xZnvTszC7MCAAUF0XfOdJa62+IaCeO40GSJA/zPP8RwB9vDjBtWmv9JRE5ImpZawdVpbo58CkAIyJnIrLAzEvOuXNm/h3AfQDOAGdj5z5m5gXn3G9ENCKilckaiDwpiFZEpCoiTyYrM3/knOtXmHs58BkABvCLc+4DZl6cxIjoh4ODA728vIzt7W2sra09PT4+fgTgQES4LMvHZIy5LyI/f/dJvfK6FKMJqAdqmBS2ZgWINY9zJyZ1whUiRJrTfmGjybSxUemwcFEmghqT1UxlUrpQEXD7jRq3NWelEz10okIi1AJOX+U2EgALgUrT0kVnmcKvQ+uazSZvbW2hWq2i3++j3W5jf38f6+vrebvdHovI5pT09+vN7teLYev990K8GpQYjS1u1TQqhnHez6EU4cM7FTw7z5AXDo16ACcyPRsaxp2FEM9ejKd7zUaIYVpiOCpRq2rUIo0XLzMwEZaaFTzvZ8hyh/iWnu69fF1AAoOfFr/A5w8eYDQaIY5jJEmC09NTNBoNdLtd7O3t4ejoCIeHh8k/pL8KUSkCZcg6hCLDjLk2ufYGpRuXAuOMYiosQiDNNEcQILQuzYgi0QxVWKuAMtcqJPdXDaKaMMOUNrOAtoFSVE5jaaY4mtQPS5dmQPS8WkdfGReYgDe/3cTdpbvo9XrY2NhAp9NBq9XKO53Ov6T/r2mlVBeX0DSAMzeHppm5h7doemdvR99buYfd3V2srq4+PTk5+a+mr9CmrqTU3+5Rr9cHg8HgYve4krddbZGb5dOXmf2d+7n4pi9D4LrOeHl40v42fl0a8KQ96fkIeJ+ej9vsWZ707Mzmy/Ck5+M2e9afhmuAz1BhwewAAAAASUVORK5CYII=" alt="Next" style="max-width: 45px; height: auto;"></span>
        </a>
      </div>
      
    </aside>
    
    <div class="comment-box">
      <a href="#" aria-label="Back to top"><img src="/assets/gold.ico" alt="Back to top"></a>&#10230;<a href="https://github.com/mvdiogo/stf-web-scraper" title="page.comment">https://github.com/mvdiogo/stf-web-scraper</a>
    </div>
    
  </article>
</body>
</html>
