---
categories:
  - Code
tags:
  - scripts
  - linux
comment: 
info: fechado.
date: '2024-01-03'
type: post
layout: post
published: true
slug: wps
title: 'install_wps.sh'

---

```
#!/bin/bash

# Function to display a message
msg() {
    color=$1
    message=$2
    echo -e "${color}${message}\e[0m"
}

# Function to display a dialog menu
_dialog() {
    title=$1
    prompt=$2
    options=("${@:3}")

    cmd=(dialog --clear --backtitle "$title" --menu "$prompt" 0 0 0)
    options=()
    for i in $(seq 0 2 $(( ${#options[@]} - 1 ))); do
        cmd+=( "${options[i]}" "${options[i+1]}" )
    done

    choice=$("${cmd[@]}" 2>&1 >/dev/tty)
    clear
    case $choice in
        1)
            _i
            ;;
        2)
            _d
            ;;
        *)
            return
            ;;
    esac
}

# Function to install WPS Office
_i() {
    if [ -d "/opt/kingsoft" ]; then
        clear
        echo -e "$red本机已安装有WPS，如想重新安装，请先卸载一遍$white"
        enter
        return
    fi
    msg $red "安装WPS（本次下载可以不用加速器！）"
    echo -e "\n$green请保持网络通畅$white"
    wget -c https://wps-linux-personal.wpscdn.cn/wps/download/ep/Linux2019/11664/wps-office_11.1.0.11664_arm64.deb -O /opt/wps.deb
    [ "$?" == "0" ] && rm -rf "/usr/share/mime/packages/custom-wps-office.xml" && sudo dpkg -i /opt/wps.deb

    wget -c https://gitee.com/ak2/ttf-wps-fonts/raw/master/ttf-wps-fonts.tar.xz -O /opt/ttf.tar.xz
    tar -Jxvf /opt/ttf.tar.xz -C /
    cd /usr/share/fonts/truetype/wps-fonts
    for i in mkfontscale mkfontdir fc-cache; do
        [[ ! $(command -v ${i}) ]] || sudo ${i}
    done

    sed -i '2{s/^/export LANGUAGE="pt_BR:pt"/}' /usr/bin/wps
    sed -i '2{s/^/export LANGUAGE="pt_BR:pt"/}' /usr/bin/wpspdf
    sed -i '2{s/^/export LANGUAGE="pt_BR:pt"/}' /usr/bin/et
    sed -i '2{s/^/export LANGUAGE="pt_BR:pt"/}' /usr/bin/wpp

    msg $green "Instalação concluída!"
    echo -e "\n\n\t$redSe não foi possível instalar corretamente devido a problemas na rede, desinstale e tente novamente.$white"
    enter
}

# Function to uninstall WPS Office
_d() {
    msg $red "Desinstalando o WPS Office"

    sudo dpkg -r wps-office
    msg $green "Desinstalação concluída!"
    enter
}

# Menu options
OPTIONS=(
    1 "Instalar o WPS Office"
    2 "Desinstalar o WPS Office"
    3 "Cancelar"
)

_dialog "Homepage -> Instalar/Desinstalar Programas -> Escritório -> WPS" "Por favor, escolha uma opção:" "${OPTIONS[@]}"
```
