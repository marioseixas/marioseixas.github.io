---
layout: default
---

<div class="post-wrapper">
  <article class="post">
    <header class="post-heading">
      <h1 class="post-title">{{ page.title }}</h1>
      <div class="search-link">
        <span>
          <span class="tags">
            <time datetime="{{ page.date | date_to_xmlschema }}">
              · {{ page.date | date_to_string }}
            </time>
            {% if page.last_modified_at %}
            &rightarrowtail;
            <time datetime="{{ page.last_modified_at | date_to_xmlschema }}">
                {{ page.last_modified_at | date_to_string }}
              </time>
            {% endif %}
          </span>          
          {% if page.tags %}
            <span>
              · Tags:
              {% for tag in page.tags %}
                <a href="{{ site.baseurl }}/tags/#{{ tag | slugify }}" class="tag">{{ tag }}</a>{% unless forloop.last %},{% endunless %}
              {% endfor %}
            </span>
          {% endif %}          
          {% if page.info %}
            <span class="tags">
              · Edit: {{ page.info }}
            </span>
          {% endif %}          
          <a href="https://github.com/marioseixas/marioseixas.github.io/edit/main/{{ page.path }}" target="_blank" rel="noopener noreferrer">
            · Improve this
          </a>
          <a href="https://github.com/marioseixas/marioseixas.github.io/commits/main/{{ page.path }}" target="_blank" rel="noopener noreferrer">
            · Revision history
          </a>
        </span>
      </div>
    </header>

    <div class="post-content-body">
      {{ content | markdownify }}
    </div>
    <!-- Mermaid.js Initialization -->
    <script src="https://unpkg.com/mermaid@10.9.0/dist/mermaid.min.js"></script>
    <script src="https://bumbu.me/svg-pan-zoom/dist/svg-pan-zoom.min.js"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        if (typeof mermaid !== 'undefined') {
          const init = () => {
            mermaid.initialize({
              startOnLoad: true,
              theme: window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'default',
              flowchart: { 
                curve: 'basis',
                useMaxWidth: false,
                rankSpacing: 40,
                nodeSpacing: 40,
                padding: 5
              },
              securityLevel: 'loose'
            });

            document.querySelectorAll('.mermaid').forEach(function(element) {
              const wrapper = document.createElement('div');
              wrapper.className = 'mermaid-wrapper';
              element.parentNode.insertBefore(wrapper, element);
              wrapper.appendChild(element);
              
              mermaid.init(undefined, element);
            });
          };

          const drawDiagram = async function () {
            const element = document.querySelector('#graphDiv');
            const graphDefinition = `
flowchart LR
a(mermaid) --> b(flowchart) --> c(flowchart) --> d(flowchart) --> e(flowchart) --> f(flowchart)
            `;
            const { svg } = await mermaid.render('mySvgId', graphDefinition);
            element.innerHTML = svg.replace(/( )*max-width:( 0-9\.)*px;/i, '');

            var doPan = false;
            var eventsHandler;
            var panZoom;
            var mousepos;

            eventsHandler = {
              haltEventListeners: ['mousedown', 'mousemove', 'mouseup']

              , mouseDownHandler: function (ev) {
                if (event.target.className == "[object SVGAnimatedString]") {
                  doPan = true;
                  mousepos = { x: ev.clientX, y: ev.clientY }
                };
              }

              , mouseMoveHandler: function (ev) {
                if (doPan) {
                  panZoom.panBy({ x: ev.clientX - mousepos.x, y: ev.clientY - mousepos.y });
                  mousepos = { x: ev.clientX, y: ev.clientY };
                  window.getSelection().removeAllRanges();
                }
              }

              , mouseUpHandler: function (ev) {
                doPan = false;
              }

              , init: function (options) {
                options.svgElement.addEventListener('mousedown', this.mouseDownHandler, false);
                options.svgElement.addEventListener('mousemove', this.mouseMoveHandler, false);
                options.svgElement.addEventListener('mouseup', this.mouseUpHandler, false);
              }

              , destroy: function (options) {
                options.svgElement.removeEventListener('mousedown', this.mouseDownHandler, false);
                options.svgElement.removeEventListener('mousemove', this.mouseMoveHandler, false);
                options.svgElement.removeEventListener('mouseup', this.mouseUpHandler, false);
              }
            }
            panZoom = svgPanZoom('#mySvgId', {
              zoomEnabled: true
              , controlIconsEnabled: true
              , fit: 1
              , center: 1
              , customEventsHandler: eventsHandler
            })
          };

          init();
          drawDiagram();

          // Dynamically adjust diagram on window resize
          let resizeTimer;
          window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
              document.querySelectorAll('.mermaid').forEach(function(element) {
                element.removeAttribute('data-processed');
              });
              init();
              drawDiagram();
            }, 250);
          });

          // Handle theme changes
          window.matchMedia('(prefers-color-scheme: dark)').addListener(function(e) {
            document.querySelectorAll('.mermaid').forEach(function(element) {
              element.removeAttribute('data-processed');
            });
            init();
            drawDiagram();
          });
        }
      });
    </script>
    <script src="{{ '/assets/js/copy-to-clipboard.js' | relative_url }}" defer></script>
  </article>
  {% cusdis_comments %}
</div>
