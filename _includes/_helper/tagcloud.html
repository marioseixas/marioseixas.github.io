{% comment %} tagcloud(min_font, max_font, amount, color, start_color, end_color) {% endcomment %}
<ul class="tagcloud-list">
  {% assign tags_list = site.tags | sort %}
  {% if amount > 0 %}
    {% assign tags_list = tags_list | slice: 0, amount %}
  {% endif %}
  {% assign max_count = tags_list.last[1].size %}
  {% assign min_count = tags_list.first[1].size %}
  
  {% for tag in tags_list %}
    {% assign tag_name = tag[0] %}
    {% assign tag_size = tag[1].size %}
    {% assign font_step = max_font | minus: min_font %}
    
    {% if max_count != min_count %}
      {% assign weight = tag_size | minus: min_count | times: 100.0 | divided_by: max_count | minus: min_count %}
    {% else %}
      {% assign weight = 0 %}
    {% endif %}
    {% assign font_size = min_font | plus: weight | times: font_step | divided_by: 100 | round: 2 %}

    {% assign style = 'font-size:' | append: font_size | append: 'px;' %}
    
    {% if color %}
      {% assign color_diff = '' %}
      {% for i in (0..2) %}
        {% assign start = start_color[i] | plus: 0 %}
        {% assign end = end_color[i] | plus: 0 %}
        {% assign diff = end | minus: start | times: weight | divided_by: 100.0 %}
        {% capture colorval %}{{ diff | plus: start | round }}{% endcapture %}
        {% assign color_diff = color_diff | append: colorval %}
        {% if forloop.last == false %}
          {% assign color_diff = color_diff | append: ',' %}
        {% endif %}
      {% endfor %}
      {% assign style = style | append: 'color: rgb(' | append: color_diff | append: ');' %}
    {% endif %}
    
    {% assign tag_url = tag_name | slugify %}
    <li class="tagcloud-item" style="{{ style }}">
      <a class="tagcloud-link">{{ tag_name }}</a>
      <span class="tagcloud-count">{{ tag_size }}</span>
    </li>
  {% endfor %}
</ul>
